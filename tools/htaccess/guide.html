<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>.htaccess文件介绍大全</title>
    <meta name="Keywords" content=".htaccess,htaccess文件,在线,伪静态,介绍,生成,制作" />
    <meta name="Description" content="什么是.htaccess文件从本指南中，你将可以学习到有关.htaccess文件及其功能的知识，并用以优化你的网站。尽管.htaccess 只是一个文件" />
    <link rel="stylesheet" href="../assets/lib/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../assets/css/style.css" />
</head>

<body>
    <div class="container">
        <nav class="navbar navbar-default">
            <div class="navbar-header">
                <a class="navbar-brand" href="../index.html">网页工具大全</a>
            </div>
            <div id="navbar" class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="index.html" title="htaccess在线编辑生成器">.HTACCESS文件在线生成</a></li>
                    <li><a href="introduce.html" title="htaccess文件介绍">文件介绍</a></li>
                    <li class="active"><a href="guide.html" title="htaccess用法大全">用法大全</a></li>
                    <li><a href="redirect.html" title="htaccess文件中的301重定向">301重定向</a></li>
                    <li><a href="error.html" title="htaccess自定义404等错误页面">自定义错误</a></li>
                    <li><a href="rewrite.html" title="使用htaccess文件伪静态">伪静态</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="http://usite.pub/index.php" title="免费空间" target="_blank">免费空间</a></li>
                    <li><a href="https://github.com/jksdou/html-tools" target="_blank">源码</a></li>
                </ul>
            </div>
        </nav>
    </div>
    <div class="container">
        <h2 class="text-center">.htaccess文件说明大全</h2>
        <hr />
        <p>1.1 什么是.htaccess文件从本指南中，你将可以学习到有关.htaccess文件及其功能的知识，并用以优化你的网站。尽管.htaccess
            只是一个文件，但它可以更改服务器的设置，允许你做许多不同的事情，最流行的功能是您可以创建自定义的“404 error”页面。.htaccess
            并不难于使用，归根结底，它只是在一个text文档中添加几条简单的指令而已。</p>
        <p>首先你要判断主机支持它</p>
        <p>这可能很难用简单的答案来回答。许多主机支持.htaccess，但实际上并不会特别声明，许多其他类型的主机有能力 但并不允许他们的用户使用.
            htaccess。一般来说，如果你的主机使用Unix或Linux系统，或任何版本的Apache网络服务器，从理论上都是支持.htaccess的，尽管你的主机服务商可能不允许你使用它。</p>
        <p>判断你的主机是否允许.htaccess，一个标志很好的是它是否支持文件夹密码保护。为达到此功能，主机服务商需要
            使用.htaccess（当然，少数情况下他们虽提供密码保护功能，但却并不允许你使用.htaccess）。如果你不确定自己的主机是否支持.
            htaccess，最好的办法是上传你自己的.htaccess文件看看是否有用，或者直接发送e-mail向你的主机服务商咨询。</p>
        <p>Apache系统中的.htaccess文件(或者”分布式配置文件”提供了针对目录改变配置的方法，即，在一个特定
            的文档目录中放置一个包含一个或多个指令的文件，以作用于此目录及其所有子目录。作为用户，所能使用的命令受到限制。管理员可以通过Apache的 AllowOverride指令来设置。</p>
        <p>子目录中的指令会覆盖更高级目录或者主服务器配置文件中的指令。</p>
        <p>.htaccess必须以ASCII模式上传，最好将其权限设置为644。</p>
        <p>.htaccess可以做大量的事情，包括：文件夹密码保护、用户自动重定向、自定义错误页面、改变你的文件扩展名、封禁特定IP地址的用户、只允许特定IP地址的用户、禁止目录列表，以及使用其他文件作为index文件。</p>
        <p>1.2
            如何创建.httaccess文件创建.htaccess文件也许会给你带来一些困难。写文件很容易，你只需要在文字编缉器（例如：写字板）里写下适当的代码。真正困难的可能是文件的保存，因为.htaccess是一个古怪的文件名（它事实上没有文件名，只有一个由8个字母组成的扩展名），而在一些系统（如windows
            3.1）中无法接受这样的文件名。在大多数的操作系统中，你需要做的是将文档保存成名为：“.htaccess”
            （包括引号）。如果这也不行，你需要将其先命名为其它名字（例如htaccess.txt），再将其上传到服务器上，之后直接使用FTP软件来重命名。</p>
        <p>警告</p>
        <p>在使用.htaccess之前，我必须给你一些警告。虽然在服务器上使用.htaccess绝对不太可能给你带来任何麻烦（如果有些东西错了，它只是没效用罢了），但如果你使用Microsoft FrontPage
            Extensions，就必须特别小心。因为FrontPage
            Extensions本身使用了.htaccess，因此你不能编辑它并加入你自己的信息。如果确实有这方面的需要（并不推荐，但是可能），你应该先从服务器上下载.htaccess文档（如果存在），之后在前面加上你的代码。
        </p>
        <p>2.httacces文件的配置</p>
        <p>2.1.配置.htaccess
            自定义错误页<br />我要介绍的.htaccess的第一个应用是自定义错误页面，这将使你可以拥有自己的、个性化的错误页面（例如找不到文件时），而不是你的服务商提供的错误页或没有任何页面。这会让你的网站在出错的时候看上去更专业。你还可以利用脚本程序在发生错误的时候通知你（例如我使用Free
            Webmaster Help的PHP脚本程序，当找不到页面的时候自动e-mail给我）。</p>
        <p>你所知道的任何页面错误代码（像404找不到页面），都可以通过在.htaccess文件里加入下面的文字将其变成自定义页面：</p>
        <p class="alert alert-info">ErrorDocument errornumber /file.html</p>
        <p>举例来说，如果我的根目录下有一个nofound.html文件，我想使用它作为404 error的页面：</p>
        <p class="alert alert-info">ErrorDocument 404 /notfound.html</p>
        <p>如果文件不在网站的根目录下，你只需要把路径设置为：</p>
        <p class="alert alert-info">ErrorDocument 500 /errorpages/500.html</p>
        <p>以下是一些最常用的错误：</p>
        <p>常用的客户端请求错误返回代码：</p>
        <p class="alert alert-info">400 - Bad request 错误请求<br />401 Authorization Required需要验证<br />403 Forbidden禁止<br />404 Not Found找不到页面
            <br />405 Method Not Allowed<br />408 Request Timed Out<br />411 Content Length Required<br />412 Precondition Failed<br />413
            Request Entity Too Long<br />414 Request URI Too Long<br />415 Unsupported Media Type</p>
        <p>常见的服务器错误返回代码：</p>
        <p>500 Internal Server Error内部服务器错误</p>
        <p>接下来，你要做的只是创建一个错误发生时显示的文件，然后把它们和.htaccess一起上传。</p>
        <p>用户可以利用.htaccess指定自己事先制作好的错误提醒页面。一般情况下，人们可以专门设立一个目录，例如errors放置这些页面。然后再.htaccess中，加入如下的指令：</p>
        <p class="alert alert-info">ErrorDocument 404 /errors/notfound.html<br />ErrorDocument 500 /errors/internalerror.html</p>
        <p>一条指令一行。上述第一条指令的意思是对于404，也就是没有找到所需要的文档的时候得显示页面为/errors目录下的notfound.html页面。不难看出语法格式为：</p>
        <p class="alert alert-info">ErrorDocument 错误代码 /目录名/文件名.扩展名</p>
        <p>如果所需要提示的信息很少的话，不必专门制作页面，直接在指令中使用HTML号了，例如下面这个例子：</p>
        <p class="alert alert-info">ErrorDocument 401 “你没有权限访问该页面，请放弃！”</p>
        <p>2.2.配置.htaccess
            停示显示目录列表<br />有些时候，由于某种原因，你的目录里没有index文件，这意味着当有人在浏览器地址栏键入了该目录的路径，该目录下所有的文件都会显示出来，这会给你的网站留下安全隐患。</p>
        <p>为避免这种情况（而不必创建一堆的新index文件），你可以在你的.htaccess文档中键入以下命令，用以阻止目录列表的显示： Options -Indexes</p>
        <p>2.3.配置.htaccess
            阻止/允许特定的IP地址某些情况下，你可能只想允许某些特定IP的用户可以访问你的网站（例如：只允许使用特定ISP的用户进入某个目录），或者想封禁某些特定的IP地址（例如：将低级用户隔离于你的信息版面外）。当然，这只在你知道你想拦截的IP地址时才有用，然而现在网上的大多数用户都使用动态IP地址，所以这并不是限制使用的常用方法。
        </p>
        <p>你可以使用以下命令封禁一个IP地址：</p>
        <p class="alert alert-info">deny from 000.000.000.000</p>
        <p>这里的000.000.000.000是被封禁的IP地址，如果你只指明了其中的几个，则可以封禁整个网段的地址。如你输入210.10.56.，则将封禁210.10.56.0～210.10.56.255的所有IP地址。</p>
        <p>你可以使用以下命令允许一个IP地址访问网站：</p>
        <p class="alert alert-info">allow from 000.000.000.000</p>
        <p>被允许的IP地址则为000.000.000.000，你可以象封禁IP地址一样封禁整个网段。</p>
        <p>如果你想阻止所有人访问该目录，则可以使用：</p>
        <p class="alert alert-info">deny from all</p>
        <p>不过这并不影响脚本程序使用这个目录下的文档。</p>
        <p>2.4.配置.htaccess 替换index文件<br />改变缺省的首页文件</p>
        <p>一般情况下缺省的首页文件名有default、index等。不过，有些时候目录中没有缺省文件，而是某个特定的文件名，比如index123.html。这种情况下，要用户记住文件名来访问很麻烦。在.htaccess中可以轻易的设置新的缺省文件名：</p>
        <p class="alert alert-info">DirectoryIndex 新的缺省文件名</p>
        <p>也可以列出多个，顺序表明它们之间的优先级别，例如：</p>
        <p class="alert alert-info">DirectoryIndex filename.html index.cgi index.pl default.htm</p>
        <p>也许你不想一直使用index.htm或index.html作为目录的索引文件。举例来说，如果你的站点使用 PHP 文件，你可能会想使用
            index.PHP来作为该目录的索引文档。当然也不必局限于“index”文档，如果你愿意，使用.htaccess你甚至能够设置
            foofoo.balh来作为你的索引文档这些互为替换的索引文件可以排成一个列表，服务器会从左至右进行寻找，检查哪个文档在真实的目录中存在。如果一个也找不到，它将会把目录列表显示出来（除非你已经关闭了显示目录文件列表）。
        </p>
        <p class="alert alert-info">DirectoryIndex index.PHP index.PHP3 messagebrd.pl index.html index.htm</p>
        <p>2.5.配置.htaccess
            重定向页面<br />.htaccess最有用的功能之一就是将请求重定向到同站内或站外的不同文档。这在你改变了一个文件名称，但仍然想让用户用旧地址访问到它时，变的极为有用。另一个应用（我发现的很有用的）是重定向到一个长URL，例如在我的时事通讯中，我可以使用一个很简短的URL
            来指向我的会员链接。以下是一个重定向文件的例子：</p>
        <p class="alert alert-info">Redirect /location/from/root/file.ext<br />http://www.uinote.com/new/file/123.html</p>
        <p>上述例子中，访问在root目录下的名为oldfile.html可以键入：</p>
        <p class="alert alert-info">/oldfile.html</p>
        <p>访问一个旧次级目录中的文件可以键入：</p>
        <p class="alert alert-info">/old/oldfile.html</p>
        <p>你也可以使用.htaccess重定向整个网站的目录。假如你的网站上有一个名为olddirectory的目录，并且你已经在一个新网站 http://www.uinote.com/newdirectory/ 上建立了与上相同的文档，你可以将旧目录下所有的文件做一次重定向而不必一一声明：</p>
        <p class="alert alert-info">Redirect /olddirectory http://www.uinote.com/newdirectory</p>
        <p>这样，任何指向到站点中/olddirectory目录的请求都将被重新指向新的站点，包括附加的额外URL信息。如果正确使用，此功能将极其强大。</p>
        <p>我们可能对网站进行重新规划，将文档进行了迁移，或者更改了目录。这时候，来自搜索引擎或者其他网站链接过来的访问就可能出错。这种情况下，可以通过如下指令来完成旧的URL自动转向到新的地址：</p>
        <p class="alert alert-info">Redirect /旧目录/旧文档名 新文档的地址</p>
        <p>或者整个目录的转向：</p>
        <p class="alert alert-info">Redirect 旧目录 新目录</p>
        <p>3.1.密码保护的.htaccess文件尽管有各种各样的.htaccess用法，但至今最流行的也可能是最有用的做法是将其用于网站目录可靠的密码保护。尽管JavaScrip等也能做到，但只有.htaccess具有完美的安全性（即访问者必须知晓密码才可以访问目录，并且绝无“后门”可走）。</p>
        <p>利用.htaccess将一个目录加上密码保护分两个步骤。第一步是在你的.htaccess文档里加上适当的几行代码，再将.htaccess文档放进你要保护的目录下：</p>
        <p class="alert alert-info">AuthName "Section Name"<br />AuthType Basic<br />AuthUserFile /full/path/to/.htpasswd<br />Require valid-user</p>
        <p>你可能需要根据你的网站情况修改一下上述内容中的一些部分，如用被保护部分的名字”Members Area”，替换掉“Section Name”。</p>
        <p>/full/parth/to/.htpasswd则应该替换为指向.htpasswd文件（后面详述该文档）的完整服务器路径。如果你不知道你网站空间的完整路径，请询问一下你的系统管理员。</p>
        <p>3.2.密码保护的.htpasswd文件</p>
        <p>目录的密码保护比.htaccess的其他功能要麻烦些，因为你必须同时创建一个包含用户名和密码的文档，用于访问你的网站，相关信息（默认）位于一个名为.htpasswd的文档里。像.htaccess一样，.htpasswd也是一个没有文件名且具有8位扩展名的文档，可以放置在你网站里的任何地方（此时密码应加密），但建议你将其保存在网站Web根目录外，这样通过网络就无法访问到它了。</p>
        <p>在使用.htaccess来设置目录的密码保护时，它包含了密码文件的路径。从安全考虑，有必要把.htaccess 也保护起来，不让别人看到其中的内容。虽然可以用其他方式做到这点，比如文档的权限。不过，.htaccess本身也能做到，只需加入如下的指令：</p>
        <p class="alert alert-info">order allow,deny<br />deny from all</p>
        <p>3.3.配置 .htaccess 输入用户名和密码<br />要利用.htaccess对某个目录下的文档设定访问用户和对应的密码，首先要做的是生成一个.htpasswd的文本文档，例如：</p>
        <p class="alert alert-info">forge:y4E7Ec8e7EwV</p>
        <p>这里密码经过加密，用户可以自己找些工具将密码加密成.htaccess支持的编码。该文档最好不要放在www目录下，建议放在www根目录文档之外，这样更为安全些。</p>
        <p>有了授权用户文档，可以在.htaccess中加入如下指令了：</p>
        <p class="alert alert-info">AuthUserFile .htpasswd的服务器目录<br />AuthGroupFile /dev/null （需要授权访问的目录）<br />AuthName EnterPassword<br />AuthType Basic （授权类型）</p>
        <p>require user wsabstract （允许访问的用户，如果希望表中所有用户都允许，可以使用 require valid-user）</p>
        <p>注，括号部分为学习时候自己添加的注释</p>
        <p>拒绝来自某个IP的访问</p>
        <p>如果我不想某个政府部门访问到我的站点的内容，那可以通过.htaccess中加入该部门的IP而将它们拒绝在外。</p>
        <p>例如：</p>
        <p class="alert alert-info">order allow,deny<br />deny from 210.10.56.32<br />deny from 219.5.45.<br />allow from all</p>
        <p>第二行拒绝某个IP，第三行拒绝某个IP段，也就是219.5.45.0~219.2.45.255</p>
        <p>想要拒绝所有人？用deny from all好了。不止用IP，也可以用域名来设定。</p>
        <p>创建好.htpasswd文档后（可以通过文字编辑器创建），下一步是输入用于访问网站的用户名和密码，应为：</p>
        <p class="alert alert-info">username:password</p>
        <p>“password”的位置应该是加密过的密码。你可以通过几种方法来得到加密过的密码：一是使用一个网上提供的
            permade脚本或自己写一个；另一个很不错的username/password加密服务是通过KxS网站，这里允许你输入用户名及密码，然后生成正确格式的密码。</p>
        <p>对于多用户，你只需要在.htpasswd文档中新增同样格式的一行即可。另外还有一些免费的脚本程序可以方便地管理.htpasswd文档，可以自动新增/移除用户等。</p>
        <p>3.4.配置.htaccess直接访问加密网站</p>
        <p>当你试图访问被.htaccess密码保护的目录时，你的浏览器会弹出标准的username/password对话窗口。如果你不喜欢这种方式，有些脚本程序可以允许你在页面内嵌入username/password输入框来进行认证，你也可以在浏览器的URL框内以以下方式输入用户名和密码（未加密的）：</p>
        <p class="alert alert-info">http://username:password@www.uinote.com/directory/</p>
        <p>3.5.利用 .htaccess 防止盗链<br />如果不喜欢别人在他们的网页上连接自己的图片、文档的话，也可以通过htaccess的指令来做到。</p>
        <p>所需要的指令如下：</p>
        <p class="alert alert-info">RewriteEngine on<br />RewriteCond %{ HTTP_REFERER } !^$<br />RewriteCond %{ HTTP_REFERER }
            !^http://(www.)?uinote.com/.*$ [NC]<br />RewriteRule .(gif &line;jpg)$ - [F]</p>
        <p>如果觉得让别人的页面开个天窗不好看，那可以用一张图片来代替：</p>
        <p class="alert alert-info">RewriteEngine on<br />RewriteCond %{ HTTP_REFERER } !^$<br />RewriteCond %{ HTTP_REFERER }
            !^http://(www.)?uinote.com/.*$ [NC]<br />RewriteRule .(gif &line;jpg)$ http://www.uinote.com/替代图片文件名
            [R,L]
        </p>
        <p>3.6.利用 .htaccess进行地址转向<br />这种方法，就是把uinote.com的流量全部
            301转向到www.uinote.com(或者反过来)。其实对于这种方法，国外有人认为对PageRank没有帮助。我觉得是因为他们看到 Google管理员工具中有一个首选域工具，可以指定Google的爬虫把
            www.uinote.com或者uinote.com作为抓取和排名的首选域，转向似乎就没有必要了。但确实又有不少人证实这是有效的，反正目前还没有人说这种方法会对SEO或者pagerank有什么损害。
        </p>
        <p>在.htaccess中写入:</p>
        <p class="alert alert-info">Options +FollowSymlinks All -Indexes<br />rewriteEngine on<br />rewriteBase /<br />RewriteCond %{HTTP_HOST}
            ^uinote.com$<br />RewriteRule ^(.*)$ http://www.uinote.com/$1 [R=301,L]</p>
        <p>3.7.利用 .htaccess对域名中“www”的控制<br />强制去除www</p>
        <p>下面以 Wordpress 为例，其它的情况，可以自己参照解决。在你的 Wordpress 目录下通常会有一个 .htaccess 文件，如果没有，那就手动建立一个。如果你设定了 permalink
            的话，.htaccess 里面的内容会有如下一坨：</p>
        <p class="alert alert-info">&lt;IfModule mod_rewrite.c&gt;<br />RewriteEngine On<br />RewriteBase /<br />RewriteCond %{REQUEST_FILENAME}
            !-f<br />RewriteCond %{REQUEST_FILENAME} !-d<br />RewriteRule . /index.php
            [L]<br />&lt;/IfModule&gt;<br />具体是啥意思咱就甭管它了，只管在 RewriteBase / 这行下面加上：</p>
        <p class="alert alert-info">RewriteCond %{HTTP_HOST} ^www.uinote.com$ [NC]<br />RewriteRule ^(.*)$ http://uinote.com/$1 [R=301,L]
        </p>
        <p>这样就大功告成了。当然要把 uinote.com 换成你自己的域名。上面两行的意思是把 www.uinote.com 这种形式改写成 uinote.com，并把访问前者的所有链接永久转向到后者。</p>
        <p>域名前强制加上www</p>
        <p>如果你实在是坚持要把 www 加在前面，我上面的算是白写了，表示遗憾。但，你可以。只需把上面添加的两行代码改成这样：</p>
        <p class="alert alert-info">RewriteCond %{HTTP_HOST} ^uinote.com$ [NC]<br />RewriteRule ^(.*)$ http://www.uinote.com/$1 [R=301,L]</p>
        <p>4.1. .htaccess 总结<br />.htaccess是一个站点管理员可以应用的强大工具，有更多的变化以适应不同的用途，可以节约时间及提高网站的安全性</p>
        <p>.htaccess的特别说明</p>
        <p>* 启用.htaccess，需要修改httpd.conf，启用AllowOverride，并可以用AllowOverride限制特定命令的使用<br />*
            如果需要使用.htaccess以外的其他文件名，可以用AccessFileName指令来改变。例如，需要使用.config ，则可以在服务器配置文件中按以下方法配置：</p>
        <p class="alert alert-info">AccessFileName .config</p>
        <p>* 一般情况下，不应该使用.htaccess文件，除非你对主配置文件没有访问权限。有一种很常见的误解，认为用户认证只能通过.htaccess文件实现，其实并不是这样，把用户认证写在主配置文件中是完全可行的，而且是一种很好的方法。
            .htaccess文件应该被用在内容提供者需要针对特定目录改变服务器的配置而又没有root权限的情况下。如果服务器管理员不愿意频繁修改配置，则可以允许用户通过.htaccess文件自己修改配置，尤其是ISP在同一个机器上运行了多个用户站点，而又希望用户可以自己改变配置的情况下。
            虽然如此，一般都应该尽可能地避免使用.htaccess文件。任何希望放在.htaccess文件中的配置，都可以放在主配置文件的&lt;Directory&gt;段中，而且更高效。避免使用.htaccess文件有两个主要原因，即性能和安全。
        </p>
        <p><a href="index.html">在线.htaccess文件生成器</a><br />能够在线生成.htaccess文件，很简单的就配置重定向,系统错误文件等。<br />敢想敢做敢坚持</p>
        <p>.htaccess文件提供了针对每个目录改变配置的方法。<br />top<br />.htaccess文件*<br />相关模块相关指令</p>
        <p class="alert alert-info">*core<br />*mod_authn_file<br />*mod_authz_groupfile<br />*mod_cgi<br />*mod_include<br />*mod_mime</p>
        <p>top<br />工作原理和使用方法*</p>
        <p>.htaccess文件(或者”分布式配置文件”)提供了针对目录改变配置的方法，即，在一个特定的文档目录中放置一个包含一个或多个指令的文件，以作用于此目录及其所有子目录。</p>
        <p>说明：如果需要使用.htaccess以外的其他文件名，可以用AccessFileName指令来改变。例如，需要使用.config，则可以在服务器配置文件中按以下方法配置：</p>
        <p class="alert alert-info">AccessFileName.config</p>
        <p>允许放在这些文件中的指令取决于AllowOverride指令，此指令按类别决定了.htaccess文件中哪些指令才是有效的。如果一个指令允许放在.htaccess文件中，则，在本手册的说明中，此指令会有一个覆盖段，其中说明了为使此指令生效而必须在
            AllowOverride指令中设置的值。</p>
        <p>例如，本手册对AddDefaultCharset指令的说明表明了，此指令可以用于.htaccess文件(见
            Context一行)，而Override一行是”FileInfo”，那么为使.htaccess中的此指令有效，则至少要设置 ”AllowOverrideFileInfo”。</p>
        <p>例子:</p>
        <p class="alert alert-info">Context:serverconfig,virtualhost,directory,.htaccess<br />Override:FileInfo</p>
        <p>如果不能确定一个特定的指令是否允许用于.htaccess文件，可以查阅手册中对指令的说明，看在Context(“上下文”)行中是否有”.htaccess.”。</p>
        <p>使用.htaccess文件的场合</p>
        <p>一般情况下，不应该使用.htaccess文件，除非你对主服务器配置文件没有存取权限。有一种很常见的误解，认为用户认证只能通过.htaccess文件实现，但并不是这样，把用户认证写在主服务器配置中是完全可行的，而且是一种很好的方法。
        </p>
        <p>在内容提供者需要针对目录改变服务器的配置而对服务器系统没有root权限时，则应该使用.htaccess文件。如果服务器管理员不愿意频繁修改配置，则可以允许用户通过.htaccess文件自己修改配置，尤其是ISP在一个机器上宿主多个用户站点，而又希望用户可以自己改变配置的情况下。
        </p>
        <p>虽然如此，一般都应该尽可能地避免使用.htaccess文件。任何希望放在.htaccess文件中的配置，都可以放在主服务器的&lt;Directory&gt;段中，而且更高效。</p>
        <p>避免使用.htaccess文件有两个主要原因。</p>
        <p>首先是性能。如果AllowOverride允许使用.htaccess文件，则，Apache需要在每个目录中查找.htaccess因此，无论是否真正用到，允许使用.htaccess文件都会导致性能的下降。另外，每次请求一个页面时，都需要读取.htaccess文件。
        </p>
        <p>还有，Apache必须在所有更高级的目录中查找.htaccess文件，使所有有效的指令都起作用(参见howdirectivesareapplied.)，所以，如果有对/www/htdocs/example中页面的请求，Apache必须查找以下文件：
        </p>
        <p class="alert alert-info">/.htaccess<br />/www/.htaccess<br />/www/htdocs/.htaccess<br />/www/htdocs/example/.htaccess</p>
        <p>而且，对此目录以外的每个文件访问，还有4个附加的文件系统访问，即使这些文件都不存在。(注意，这可能仅仅发生在/允许使用.htaccess文件的情况下，虽然这种情况并不多。)</p>
        <p>其次是安全。如此，会允许用户修改服务器的配置，可能会导致未加限制的修改，请认真考虑是否给予用户这样的特权。但是，如果给予用户较少的特权而不能满足其需要，则会带来额外的技术支持请求，所以，必须明确地告诉用户已经给予他们的权限，说明
            AllowOverride设置的值，并引导他们参阅相应的说明，以免日后许多麻烦。</p>
        <p>注意，在/www/htdocs/example目录下.htaccess文件中放置指令，与，在主服务器配置文件中&lt;Directory/www/htdocs/example&gt;段中放置相同指令，是等效的。：
        </p>
        <p class="alert alert-info">/www/htdocs/example中的.htaccess:</p>
        <p>/www/htdocs/example中.htaccess文件的内容</p>
        <p class="alert alert-info">/example.exm</p>
        <p>httpd.conf文件中的段</p>
        <p class="alert alert-info">&lt;Directory/www/htdocs/example&gt;<br />AddType text/example.exm<br />&lt;/Directory&gt;</p>
        <p>但是，把这个配置放置在服务器配置文件中则更加高效，因为只需要在Apache启动时读取一次，而不是在有文件请求时每次都读取。</p>
        <p>将AllowOverride设置为”none”可以完全禁止使用.htaccess文件。</p>
        <p class="alert alert-info">AllowOverrideNone</p>
        <p>指令的生效</p>
        <p>.htaccess文件中的配置指令作用于.htaccess文件所在的目录及其所有子目录，但是，很重要需要记住的是，其更高级的目录也可能会有.htaccess文件，而指令是按查找顺序依次生效，所以，一个特定目录下的.htaccess文件中的指令可能会覆盖其更高级目录中的.htaccess文件的指令，即，子目录中的指令会覆盖更高级目录或者主服务器配置文件中的指令。
        </p>
        <p>例如:目录/www/htdocs/example1中的.htaccess文件有如下内容：</p>
        <p class="alert alert-info">Options+ExecCGI</p>
        <p>(注意:必须设置”AllowOverrideOptions”以允许在.htaccess文件中使用”Options”指令。)</p>
        <p>在目录/www/htdocs/example1/example2中的.htaccess文件有如下内容：</p>
        <p class="alert alert-info">OptionsIncludes</p>
        <p>由于第二个.htaccess文件的存在，/www/htdocs/example1/example2中的CGI执行是不允许的，而只允许OptionsIncludes，它完全覆盖了之前的设置。</p>
        <p>认证举例</p>
        <p>如果你为了知道如何认证，直接从这里开始看，有很重要的一点需要注意，有一种常见的误解，认为实现密码认证必须要使用.htaccess文件，其实不是这样。把认证指令放在主服务器配置文件的&lt;Directory&gt;段中是一个更好的方法，而.htaccess文件应该仅仅用于无权访问主服务器配置文件的时候。参见上述的使用.htaccess文件的场合。
        </p>
        <p>有此声明在先，如果你仍然需要使用.htaccess文件，请看以下说明。</p>
        <p>必须设置”AllowOverrideAuthConfig”以允许这些指令生效</p>
        <p>.htaccess文件的内容:</p>
        <p class="alert alert-info">AuthTypeBasic<br />AuthName”PasswordRequired”<br />AuthUserFile/www/passwords/password.file<br />AuthGroupFile/www/passwords/group.file<br />RequireGroupadmins</p>
        <p>注意，必须设置AllowOverrideAuthConfig以允许这些指令生效</p>
        <p>更详细的有关身份识别和认证的说明，请参见authenticationtutorial。</p>
        <p>服务器端包含举例</p>
        <p>.htaccess文件的另一个常见用途是允许一个特定目录的服务器端包含(ServerSideIncludes)，可以在需要的目录中放置.htaccess文件，并如下配置：</p>
        <p class="alert alert-info">Options+Includes<br />AddTypetext/htmlshtml<br />AddHandlerserver-parsedshtml</p>
        <p>注意，必须同时设置AllowOverrideOptions和AllowOverrideFileInfo使这些指令生效。</p>
        <p>更详细的有关服务器端包含的说明，请参见SSItutorial。</p>
        <p>CGI举例</p>
        <p>最后，可以通过.htaccess文件允许在特定目录中执行CGI程序，需按如下配置：</p>
        <p class="alert alert-info">Options+ExecCGI<br />AddHandlercgi-scriptcgipl</p>
        <p>另外，如下，可以使给定目录下所有文件被视为CGI程序：</p>
        <p class="alert alert-info">Options+ExecCGI<br />SetHandlercgi-script</p>
        <p>注意，必须设置AllowOverrideOptions使这些指令生效。</p>
        <p>更详细的有关CGI编程和配置的说明，请参见CGItutorial。</p>
        <p>疑难解答</p>
        <p>如果在.htaccess文件中写入了配置指令但不起作用，可能有多种原因。</p>
        <p>最常见的原因是，AllowOverride指令没有被正确设置，必须确保没有对此文件区域设置
            AllowOverrideNone。有一个很好的测试方法，即，在.htaccess文件随便增加点没用的内容，如果服务器没有返回了一个错误消息，那么几乎可以断定设置了AllowOverrideNone。</p>
        <p>在访问文档时，如果收到服务器的出错消息，应该检查Apache的出错日志，可以知道.htaccess文件中哪些指令是不允许使用的，也可能会发现需要纠正的语法错误。</p>
    </div>
    <footer class="footer">
        <div class="container">
            <p class="text-muted">
                <span>&copy; 2019 <a href="https://github.com/jksdou" target="blank">Jackson Dou</a></span>
                <span class="pull-right">Powered by <a href="https://crogram.com" target="_blank">Crogram</a></span>
            </p>
        </div>
    </footer>
</body>

</html>